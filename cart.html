<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>My Cart | Central & Stores</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Poppins',sans-serif;}
body{background:#f2f4f7;}

.header{
  background:#0fbf4a;
  color:#fff;
  padding:18px;
  text-align:center;
  font-size:20px;
  font-weight:700;
}

.cart-wrapper{padding:16px;}

.cart-card{
  background:#fff;
  border-radius:16px;
  padding:14px;
  margin-bottom:12px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  box-shadow:0 6px 16px rgba(0,0,0,.08);
}

.cart-title{font-weight:600;font-size:15px;}
.qty-box{display:flex;align-items:center;gap:10px;margin-top:6px;}
.qty-box button{
  width:28px;height:28px;border:none;border-radius:50%;
  background:#0fbf4a;color:#fff;font-size:18px;font-weight:700;
}
.qty-box span{font-weight:600;}

.remove-btn{
  background:#ffecec;color:#e53935;border:none;
  padding:6px 10px;border-radius:8px;font-size:12px;
}

.disclaimer{
  background:#fff8e1;
  margin:16px;
  padding:14px;
  border-radius:14px;
  font-size:13px;
  line-height:1.5;
}

.footer{
  position:sticky;bottom:0;background:#fff;padding:14px;border-top:1px solid #ddd;
}
.footer button{
  width:100%;padding:14px;border:none;border-radius:14px;
  background:#0fbf4a;color:#fff;font-size:16px;font-weight:700;
}

.cart-summary{
  position:sticky;
  bottom:0;
  background:#fff;
  border-radius:20px 20px 0 0;
  padding:16px;
  box-shadow:0 -10px 25px rgba(0,0,0,.12);
  margin-top:20px;
}

.summary-row{
  display:flex;
  justify-content:space-between;
  font-size:15px;
  font-weight:600;
  margin-bottom:10px;
}

#cartTotal{
  font-size:18px;
  font-weight:800;
  color:#16a34a;
}

.min-alert{
  font-size:13px;
  color:#e11d48;
  margin-bottom:10px;
  display:none;
}

.proceed-btn{
  width:100%;
  padding:14px;
  border:none;
  border-radius:16px;
  background:#16a34a;
  color:#fff;
  font-size:16px;
  font-weight:800;
}

.proceed-btn:disabled{
  background:#9ca3af;
}
</style>
</head>

<body>

<div class="header">ðŸ›’ My Cart</div>

<div class="cart-wrapper" id="cartWrapper"></div>
<!-- CART SUMMARY -->
<div id="cartSummary" class="cart-summary">
  <div class="summary-row">
    <span>Items</span>
    <span id="itemCount">0</span>
  </div>

  <div class="summary-row">
    <span>Estimated Total</span>
    <span id="cartTotal">â‚¹0</span>
  </div>

  <div id="minAlert" class="min-alert">
    Minimum order value is â‚¹200
  </div>
  
<div class="disclaimer">
  <strong>ðŸ“ž Order Confirmation</strong><br>
  After placing an order, we will call you to confirm and update product details.
</div>

<div class="footer">
  <button onclick="goToOrder()">Proceed to Order</button>
</div>

<script src="price.js"></script>
<script>
let cart = JSON.parse(localStorage.getItem("cart")) || [];
const MIN_ORDER = 200;

const cartWrapper = document.getElementById("cartWrapper");
const cartTotalEl = document.getElementById("cartTotal");
const itemCountEl = document.getElementById("itemCount");
const minAlert = document.getElementById("minAlert");
const proceedBtn = document.getElementById("proceedBtn");

/* RENDER CART */
function renderCart() {
  cartWrapper.innerHTML = "";

  if (cart.length === 0) {
    cartWrapper.innerHTML = `<p style="text-align:center;opacity:.6">Cart is empty</p>`;
    cartTotalEl.innerText = "â‚¹0";
    itemCountEl.innerText = "0";
    proceedBtn.disabled = true;
    return;
  }

  cart.forEach((item, i) => {
    cartWrapper.innerHTML += `
      <div class="cart-card">
        <div class="cart-title">${item.name}</div>

        <div class="qty-box">
          <button onclick="updateQty(${i}, -1)">âˆ’</button>
          <span>${item.qty}</span>
          <button onclick="updateQty(${i}, 1)">+</button>
        </div>

        <button class="remove-btn" onclick="removeItem(${i})">Remove</button>
      </div>
    `;
  });

  calculateCartTotal();
}

/* UPDATE QTY */
function updateQty(i, d) {
  cart[i].qty += d;
  if (cart[i].qty < 1) cart[i].qty = 1;
  localStorage.setItem("cart", JSON.stringify(cart));
  renderCart();
}

/* REMOVE ITEM */
function removeItem(i) {
  cart.splice(i, 1);
  localStorage.setItem("cart", JSON.stringify(cart));
  renderCart();
}

/* TOTAL CALCULATION */
function calculateCartTotal() {
  let total = 0;
  let count = 0;

  cart.forEach(item => {
    const price = getPrice(item.name); // from price.js
    total += price * item.qty;
    count += item.qty;
  });

  cartTotalEl.innerText = "â‚¹" + total;
  itemCountEl.innerText = count;

  if (total < MIN_ORDER) {
    minAlert.style.display = "block";
    proceedBtn.disabled = true;
  } else {
    minAlert.style.display = "none";
    proceedBtn.disabled = false;
  }
}

/* GO TO ORDER */
function goToOrder() {
  if (cart.length === 0) {
    alert("Cart is empty");
    return;
  }
  window.location.href = "order.html";
}

renderCart();
</script>

</body>
</html>
